---
const { name, registryUrl = "https://piperubio-shadcn-registry.vercel.app", className = "" } = Astro.props;
const cmd = `pnpm dlx shadcn@latest add ${registryUrl}/r/${name}.json`;
const id = `install-cmd-${name}`;
---

<div class={className}>
  <div class="text-sm font-medium">Instalar</div>
  <div class="mt-2 flex items-start gap-2">
    <pre id={id} class="rounded border px-3 py-2 bg-surface text-sm" style="white-space:pre-wrap">{cmd}</pre>
    <button class="rounded px-3 py-2 border" data-target={id}>Copiar</button>
  </div>
</div>

<script>
  // Copiar al portapapeles (delegaciÃ³n simple, sin dependencias)
  document.addEventListener('click', (e) => {
    const targetEl = e.target;
    if (!(targetEl instanceof HTMLElement)) return;
    const target = targetEl.getAttribute('data-target');
    if (!target) return;
    const el = document.getElementById(target);
    if (!el) return;
    const text = el.textContent || '';
    navigator.clipboard?.writeText(text).then(() => {
      const prev = targetEl.textContent || '';
      targetEl.textContent = 'Copiado';
      setTimeout(() => (targetEl.textContent = prev), 1200);
    });
  });
</script>
